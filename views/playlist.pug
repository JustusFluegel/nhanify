extends layout

block main
  if(playlistTotal === 0) 
    if (user !== undefined)
      a(href=`/${playlistType}/playlists/playlist/${playlistId}/contributors/1`) Contributors
    if(playlistType === "your")
      a(href=`/${playlistType}/playlists/playlist/${page}/${playlistId}/contributors/add`) Add 
    p(class="errorTxt") There are currently no songs on the playlist.
    if(playlistTotal === 0 && (playlistType === "your" || playlistType === "contribution")) 
      p(class="errorTxt") Add a song below.
      .errorMessages
        - let msgTypes = Object.keys(flash || {})
        if (msgTypes.length > 0) 
          each msgType in msgTypes
            each msg in flash[msgType]
              pre(class=`${msgType}`) #{msg}
      .playlistsDiv
        .addDiv
          form(class="addForm" action=`/${playlistType}/playlists/playlist/${page}/${playlistId}/add` method="post")
            .verticalDiv
              .songInputDiv
                input(class="inputURL" id="url" type="text" name="url" placeholder="Youtube URL" value=url) 
                input(class="inputURL" id="title" type="text" name="title" placeholder="Video Title" value=title) 
            input(class="addBtn" type="submit" value="Add")
  else 
    .playlistsDiv
      h1(class="pageTitle") #{pageTitle}
      block listWrap 
        block list 
          .listHeader
            .headerLeft
              - let songLabel = playlist.songTotal < 2 ? "Song" : "Songs"
              p(class="username") #{playlist.songTotal} #{songLabel}
            if (user !== undefined)
              a(href=`/${playlistType}/playlists/playlist/${playlistId}/contributors/1`) Contributors
            if(playlistType === "your")
              a(href=`/${playlistType}/playlists/playlist/${page}/${playlistId}/contributors/add`) Add 
          .errorMessages
            - let msgTypes = Object.keys(flash || {})
            if (msgTypes.length > 0) 
              each msgType in msgTypes
                each msg in flash[msgType]
                  pre(class=`${msgType}`) #{msg}
          a(href=`/${playlistType}/playlists/${page}`) Back
          .iframeDiv
            #player
          .currentSongcols
            .labelPlayIcon
            .labelNo
              p(class="username") No.
            .labelTitle
              p(class="username") Title
            .labelAddedBy
              p(class="username") Added By
          .currentSong
            .playIcon
              p ♫
            .valNo
              p(id="curSongNo") ...
            .valTitle
              p(id="curSongTitle") ...
            .valAddedBy
              p(id="curAddedBy") ...
          if (playlistType !== "public" && playlistType !== "anonPublic")
            .addDiv
              form(class="addForm" action=`/${playlistType}/playlists/playlist/${page}/${playlistId}/add` method="post")
                .verticalDiv
                  .songInputDiv
                    input(class="inputURL" id="url" type="text" name="url" placeholder="Youtube URL" value=url) 
                    input(class="inputURL" id="title" type="text" name="title" placeholder="Video Title" value=title) 
                input(class="addBtn" type="submit" value="Add")
          .pageNav 
            if (page > 1) 
              a(href=`/${playlistType}/playlists/playlist/${page - 1}/${playlistId}`) ⮜
            .pages
              - for (let pageNum  = startPage ; pageNum <= endPage; pageNum++)
                -console.log({pageNum, page});
                a(class=`${(pageNum === page) ? "curPage" : ""}` href=`/${playlistType}/playlists/playlist/${pageNum}/${playlistId}`) #{pageNum}
            if (page < totalPages) 
              a(href=`/${playlistType}/playlists/playlist/${page + 1}/${playlistId}`) ⮞
          .cols
            .labelNo
              p(class="username" style) No.
            .labelTitle
              p(class="username") Title
            .labelAddedBy
              p(class="username") Added By
        block values
          .content
            .playListWrap
              each song in playlist.songs
                div(class="songCard" data-video-id=`${song.video_id}`)
                  .descriptionDiv
                    .valNo
                      p= playlist.songs.indexOf(song) + 1
                    .valTitle
                      p= song.title   
                    .valAddedBy
                      p= song.added_by
                  .modDiv
                    if (user !== undefined && playlistType !== "public")
                      .valEdit
                        form(class="delete" action=`/${playlistType}/playlists/playlist/${page}/${playlistId}/${song.id}/edit` method="get")
                          input(class="editBtn" type="submit" value="")
                      .valDelete
                        if (user !== undefined)
                          form(class="delete" action=`/${playlistType}/playlists/playlist/${page}/${playlistId}/${song.id}/delete` method="post")
                            input(class="deleteBtn" type="submit" value="")
